package commCalc;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Scanner;
import java.util.stream.Stream;
import java.util.Properties;

public class CommCalc {

	public static void main(String[] args) {

		Scanner scanner = new Scanner(System.in);
		BufferedWriter bw = null;

		System.out.println("Enter first name: ");
		String firstName = scanner.nextLine();
		System.out.println("Enter last name: ");
		String lastName = scanner.nextLine();
		System.out.println("Enter product: ");
		String product = scanner.nextLine();
		System.out.println("Comments: ");
		String comments = scanner.nextLine();
		System.out.println("Date: ");
		String date = scanner.nextLine();

		try {
			bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
			bw.write(firstName);
			bw.newLine();
			bw.flush();

		} catch (IOException e) {
			e.printStackTrace();
		}
		try {
			bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
			bw.write(lastName);
			bw.newLine();
			bw.flush();

		} catch (IOException e) {
			e.printStackTrace();
		}
		try {
			bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
			bw.write(product);
			bw.newLine();
			bw.flush();

		} catch (IOException e) {
			e.printStackTrace();
		}
		try {
			bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
			bw.write(comments);
			bw.newLine();
			bw.flush();

		} catch (IOException e) {
			e.printStackTrace();
		}

		try {
			bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
			bw.write(date);
			bw.newLine();
			bw.flush();

		} catch (IOException e) {
			e.printStackTrace();
		}

		System.out.println("Enter book price: ");
		double book = scanner.nextDouble();

		System.out.println("Enter actual price: ");
		double actual = scanner.nextDouble();

		double drop = ((book - actual) / book);

		double commperc = (.48 - (drop)) / 2;

		if (drop > .48) {
			System.out.println("Dropped " + 100 * drop
					+ " %, which is greater than a 48% drop. Diller will sarcastically tell you this later when you ask why your commission sucks.Commission is "
					+ .02 * actual * .7 + " of " + .24 * book);

			double email = .02 * actual * .7;
			double email2 = .24 * book;
			String email3 = " of ";

			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf(actual));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}
			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf(.02 * actual * .7));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}
			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf("----"));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}

			// Recipient's email ID needs to be mentioned.
			String to = "wmsaint17@gmail.com";

			// Sender's email ID needs to be mentioned
			String from = "wyatt.saint@aspenwindows.com";

			// Assuming you are sending email from through gmails smtp
			String host = "smtp.gmail.com";

			// Get system properties
			Properties properties = System.getProperties();

			// Setup mail server
			properties.put("mail.smtp.host", host);
			properties.put("mail.smtp.port", "465");
			properties.put("mail.smtp.ssl.enable", "true");
			properties.put("mail.smtp.auth", "true");

			// Get the Session object.// and pass username and password
			Session session = Session.getInstance(properties, new javax.mail.Authenticator() {

				protected PasswordAuthentication getPasswordAuthentication() {

					return new PasswordAuthentication("wyatt.saint@aspenwindows.com", "Swatts0429*");

				}

			});

			// Used to debug SMTP issues
			session.setDebug(true);

			try {
				// Create a default MimeMessage object.
				MimeMessage message = new MimeMessage(session);

				// Set From: header field of the header.
				message.setFrom(new InternetAddress(from));

				// Set To: header field of the header.
				message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));

				// Set Subject: header field
				message.setSubject("SOLD!!");

				// Now set the actual message
				message.setText(String.valueOf(email + email3 + email2));

				System.out.println("sending...");
				// Send message
				Transport.send(message);
				System.out.println("Sent message successfully....");
			} catch (MessagingException mex) {
				mex.printStackTrace();
			}
		}

		else if (drop > .44) {
			System.out.println(
					"Dropped " + 100 * drop + " %, which is greater than a 44% drop but less than 48%. Commission is "
							+ .02 * actual * .7 + " of " + .24 * book);

			double email = .02 * actual * .7;
			double email2 = .24 * book;
			String email3 = " of ";

			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf(actual));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}

			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf(.02 * actual * .7));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}
			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf("----"));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}
			// Recipient's email ID needs to be mentioned.
			String to = "wmsaint17@gmail.com";

			// Sender's email ID needs to be mentioned
			String from = "wyatt.saint@aspenwindows.com";

			// Assuming you are sending email from through gmails smtp
			String host = "smtp.gmail.com";

			// Get system properties
			Properties properties = System.getProperties();

			// Setup mail server
			properties.put("mail.smtp.host", host);
			properties.put("mail.smtp.port", "465");
			properties.put("mail.smtp.ssl.enable", "true");
			properties.put("mail.smtp.auth", "true");

			// Get the Session object.// and pass username and password
			Session session = Session.getInstance(properties, new javax.mail.Authenticator() {

				protected PasswordAuthentication getPasswordAuthentication() {

					return new PasswordAuthentication("wyatt.saint@aspenwindows.com", "Swatts0429*");

				}

			});

			// Used to debug SMTP issues
			session.setDebug(true);

			try {
				// Create a default MimeMessage object.
				MimeMessage message = new MimeMessage(session);

				// Set From: header field of the header.
				message.setFrom(new InternetAddress(from));

				// Set To: header field of the header.
				message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));

				// Set Subject: header field
				message.setSubject("SOLD!!");

				// Now set the actual message
				message.setText(String.valueOf(email + email3 + email2));

				System.out.println("sending...");
				// Send message
				Transport.send(message);
				System.out.println("Sent message successfully....");
			} catch (MessagingException mex) {
				mex.printStackTrace();
			}
		}

		else {
			double comm = commperc * actual * .7;
			System.out.println("Dropped " + 100 * drop + " %. Commission is " + comm + " of " + .24 * book);

			double email = comm;
			double email2 = .24 * book;
			String email3 = " of ";

			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf(actual));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}

			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf(comm));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}
			try {
				bw = new BufferedWriter(new FileWriter("custinfo.txt", true));
				bw.write(String.valueOf("----"));
				bw.newLine();
				bw.flush();

			} catch (IOException e) {
				e.printStackTrace();
			}
			// Recipient's email ID needs to be mentioned.
			String to = "wmsaint17@gmail.com";

			// Sender's email ID needs to be mentioned
			String from = "wyatt.saint@aspenwindows.com";

			// Assuming you are sending email from through gmails smtp
			String host = "smtp.gmail.com";

			// Get system properties
			Properties properties = System.getProperties();

			// Setup mail server
			properties.put("mail.smtp.host", host);
			properties.put("mail.smtp.port", "465");
			properties.put("mail.smtp.ssl.enable", "true");
			properties.put("mail.smtp.auth", "true");

			// Get the Session object.// and pass username and password
			Session session = Session.getInstance(properties, new javax.mail.Authenticator() {

				protected PasswordAuthentication getPasswordAuthentication() {

					return new PasswordAuthentication("wyatt.saint@aspenwindows.com", "Swatts0429*");

				}

			});

			// Used to debug SMTP issues
			session.setDebug(true);

			try {
				// Create a default MimeMessage object.
				MimeMessage message = new MimeMessage(session);

				// Set From: header field of the header.
				message.setFrom(new InternetAddress(from));

				// Set To: header field of the header.
				message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));

				// Set Subject: header field
				message.setSubject("SOLD!!");

				// Now set the actual message
				message.setText(String.valueOf(email + email3 + email2));

				System.out.println("sending...");
				// Send message
				Transport.send(message);
				System.out.println("Sent message successfully....");
			} catch (MessagingException mex) {
				mex.printStackTrace();
			}
		}

	}
}
